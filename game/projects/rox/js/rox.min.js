/* Rox by Photon Storm Ltd. */
Rox={score:0,music:null,orientated:!1},Rox.Boot=function(){},Rox.Boot.prototype={preload:function(){this.load.image("preloaderBar","images/preload.png")},create:function(){this.physics.startSystem(Phaser.Physics.ARCADE),this.input.maxPointers=1,this.game.device.desktop?(this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.minWidth=320,this.scale.minHeight=200,this.scale.maxWidth=800,this.scale.maxHeight=600,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.setScreenSize(!0)):(this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.minWidth=480,this.scale.minHeight=260,this.scale.maxWidth=1024,this.scale.maxHeight=768,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.forceOrientation(!0,!1),this.scale.hasResized.add(this.gameResized,this),this.scale.enterIncorrectOrientation.add(this.enterIncorrectOrientation,this),this.scale.leaveIncorrectOrientation.add(this.leaveIncorrectOrientation,this),this.scale.setScreenSize(!0)),this.state.start("Preloader")},gameResized:function(){},enterIncorrectOrientation:function(){Rox.orientated=!1,document.getElementById("orientation").style.display="block"},leaveIncorrectOrientation:function(){Rox.orientated=!0,document.getElementById("orientation").style.display="none"}},Rox.Preloader=function(){this.background=null,this.preloadBar=null,this.ready=!1},Rox.Preloader.prototype={preload:function(){this.preloadBar=this.add.sprite(0,100,"preloaderBar"),this.load.setPreloadSprite(this.preloadBar),this.load.image("photonstorm","images/photonstorm.png"),this.load.image("space","images/space.png"),this.load.image("bullet","images/bullets.png"),this.load.image("ship","images/ship.png"),this.load.spritesheet("flash","images/muzzle-flash.png",48,48),this.load.image("asteroid1","images/asteroid1.png"),this.load.image("asteroid2","images/asteroid2.png"),this.load.image("asteroid3","images/asteroid3.png"),this.load.image("jets","images/smoke.png")},create:function(){this.state.start("Game")},update:function(){}},Rox.MainMenu=function(){this.music=null,this.playButton=null},Rox.MainMenu.prototype={create:function(){this.add.image(390,360,"photonstorm"),this.input.onDown.addOnce(this.startGame,this)},update:function(){},startGame:function(){this.state.start("Game")}},Rox.Player=function(a,b,c){return Phaser.Sprite.call(this,a,b,c,"ship"),this.anchor.set(.5),this.physics=a.physics.arcade,this.physics.enable(this),this.body.drag.set(100),this.body.maxVelocity.set(200),this.speed=200,this.turnSpeed=300,this.muzzle=new Phaser.Sprite(a,b,c,"flash",0),this.muzzle.anchor.set(.5),this.muzzle.animations.add("fire1",[0,1,0],30,!1),this.muzzle.animations.add("fire2",[0,2,0],30,!1),this.muzzle.animations.add("fire3",[0,3,0],30,!1),this.muzzle.animations.add("fire4",[0,4,0],30,!1),this.bullets=new Rox.PlayerBullets(a,50),this.trail=new Phaser.Particles.Arcade.Emitter(a,0,0,1e3),this.trail.makeParticles("jets"),this.trail.gravity=0,this.trail.minParticleSpeed.set(-50,50),this.trail.maxParticleSpeed.set(50,100),this.trail.setAlpha(1,0,3e3),this.trail.setScale(1,0,1,0,3e3),this.isThrusting=!1,this},Rox.Player.prototype=Object.create(Phaser.Sprite.prototype),Rox.Player.prototype.constructor=Rox.Player,Rox.Player.prototype.update=function(){this.game.world.wrap(this,16),this.muzzle.x=this.x,this.muzzle.y=this.y,this.muzzle.rotation=this.rotation,this.trail.emitX=this.x,this.trail.emitY=this.y;var a=this.body.velocity.x,b=this.body.velocity.y;a*=-1,b*=-1,this.trail.minParticleSpeed.set(a,b),this.trail.maxParticleSpeed.set(a,b),this.body.speed>50&&!this.isThrusting&&this.trail.start(!0,3e3,8),this.trail.forEachExists(this.game.world.wrap,this.game.world)},Rox.Player.prototype.zero=function(){this.body.acceleration.set(0),this.body.angularVelocity=0,this.isThrusting=!1},Rox.Player.prototype.thrust=function(){this.physics.accelerationFromRotation(this.rotation,this.speed,this.body.acceleration),this.trail.start(!0,3e3,8),this.isThrusting=!0},Rox.Player.prototype.rotateLeft=function(){this.body.angularVelocity=-this.turnSpeed},Rox.Player.prototype.rotateRight=function(){this.body.angularVelocity=this.turnSpeed},Rox.Player.prototype.fire=function(){this.bullets.fire(this)&&this.muzzle.play("fire1")},Rox.PlayerBullets=function(a,b){return Phaser.Group.call(this,a),this.physics=a.physics.arcade,this.enableBody=!0,this.physicsBodyType=Phaser.Physics.ARCADE,this.createMultiple(b,"bullet"),this.setAll("anchor.x",.5),this.setAll("anchor.y",.5),this.fireRate=100,this.bulletTime=0,this.bulletSpeed=400,this.bulletLifeSpan=1500,this},Rox.PlayerBullets.prototype=Object.create(Phaser.Group.prototype),Rox.PlayerBullets.prototype.constructor=Rox.PlayerBullets,Rox.PlayerBullets.prototype.update=function(){this.forEachExists(this.game.world.wrap,this.game.world)},Rox.PlayerBullets.prototype.fire=function(a){if(this.game.time.now>=this.bulletTime){var b=this.getFirstExists(!1);if(b)return b.reset(a.body.x+16,a.body.y+16),b.lifespan=this.bulletLifeSpan,b.rotation=a.rotation,this.physics.velocityFromRotation(a.rotation,this.bulletSpeed,b.body.velocity),this.bulletTime=this.game.time.now+this.fireRate,!0}return!1},Rox.Asteroid=function(a,b,c){return Phaser.Sprite.call(this,a,b,c,"asteroid3"),this.anchor.set(.5),this.physics=a.physics.arcade,this.physics.enable(this),this.body.velocity.x=67,this.body.velocity.y=139,this.body.angularVelocity=30,this.speed=100,this},Rox.Asteroid.prototype=Object.create(Phaser.Sprite.prototype),Rox.Asteroid.prototype.constructor=Rox.Asteroid,Rox.Asteroid.prototype.update=function(){this.game.world.wrap(this,16)},Rox.Asteroid.prototype.zero=function(){},Rox.Game=function(){this.player,this.cursors,this.fireButton},Rox.Game.prototype={create:function(){this.player=new Rox.Player(this.game,200,200);var a=this.add.tileSprite(0,0,this.game.width,this.game.height,"space");this.add.existing(this.player.trail),this.add.existing(this.player.bullets),this.add.existing(this.player.muzzle),this.add.existing(this.player),this.cursors=this.input.keyboard.createCursorKeys(),this.fireButton=this.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.world.sendToBack(a)},update:function(){this.player.zero(),this.cursors.up.isDown&&this.player.thrust(),this.cursors.left.isDown?this.player.rotateLeft():this.cursors.right.isDown&&this.player.rotateRight(),this.fireButton.isDown&&this.player.fire()},gameOver:function(){},quitGame:function(){this.state.start("MainMenu")}};